!function(t){var s={};function i(h){if(s[h])return s[h].exports;var n=s[h]={i:h,l:!1,exports:{}};return t[h].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=s,i.d=function(t,s,h){i.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:h})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"h",{value:!0})},i.t=function(t,s){if(1&s&&(t=i(t)),8&s)return t;if(4&s&&"object"==typeof t&&t&&t.h)return t;var h=Object.create(null);if(i.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var n in t)i.d(h,n,function(s){return t[s]}.bind(null,n));return h},i.n=function(t){var s=t&&t.h?function(){return t.default}:function(){return t};return i.d(s,"a",s),s},i.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},i.p="",i(i.s=1)}([function(t,s,i){},function(t,s,i){"use strict";i.r(s);class h{constructor(){}}h.VX=.2,h.VY=.2;class n{constructor(){}static add(t,s){return[t[0]+s[0],t[1]+s[1]]}static sub(t,s){return[t[0]-s[0],t[1]-s[1]]}static scale(t,s){return[t[0]*s,t[1]*s]}static len2(t){return t[0]*t[0]+t[1]*t[1]}static len(t){return Math.sqrt(n.len2(t))}static min(t,s){return n.len2(s)<n.len2(t)?s:t}static max(t,s){return n.len2(s)>n.len2(t)?s:t}static normalize(t){return n.scale(t,1/n.len(t))}}class r{constructor(t,s){this.center=t,this.halfDimension=s}intersects(t){const s=n.add(this.halfDimension,t.halfDimension);return Math.abs(this.center[0]-t.center[0])<=s[0]&&Math.abs(this.center[1]-t.center[1])<=s[1]}containsPoint(t,s){return Math.abs(this.center[0]-t)<=this.halfDimension[0]&&Math.abs(this.center[1]-s)<=this.halfDimension[1]}get minX(){return this.center[0]-this.halfDimension[0]}get maxX(){return this.center[0]+this.halfDimension[0]}get minY(){return this.center[1]-this.halfDimension[1]}get maxY(){return this.center[1]+this.halfDimension[1]}}class e{constructor(){}static isEqual(t,s){if(t===s)return!0;if(t.length!==s.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==s[i])return!1;return!0}static isMac(){return-1!==navigator.platform.indexOf("Mac")}}class o extends class{constructor(t){this.ctx=t.getContext("2d")}render(t){this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.fillStyle="#0f0";for(const s of t.platforms)this.ctx.fillRect(s.aabb.minX,s.aabb.minY,2*s.aabb.halfDimension[0],2*s.aabb.halfDimension[1]);this.ctx.fillStyle="#f00",this.ctx.fillRect(t.ball.aabb.minX,t.ball.aabb.minY,2*t.ball.aabb.halfDimension[0],2*t.ball.aabb.halfDimension[1])}}{constructor(t,s,i){super(t),this.u=s,this.g=i,this.M="",this.$=[],this.k=[t.width/s,t.height/i],this.O=n.scale(this.k,.5),this.j=new Uint8ClampedArray(i*s*3)}render(t){super.render(t);const s=this.ctx.getImageData(0,0,this.ctx.canvas.width,this.ctx.canvas.height);for(let t=0;t<this.g;t++){const i=Math.floor(this.O[1]+t*this.k[1]);for(let h=0;h<this.u;h++){const n=Math.floor(this.O[0]+h*this.k[0]);this.j[t*this.u*3+3*h+0]=s.data[i*this.ctx.canvas.width*4+4*n+0],this.j[t*this.u*3+3*h+1]=s.data[i*this.ctx.canvas.width*4+4*n+1],this.j[t*this.u*3+3*h+2]=s.data[i*this.ctx.canvas.width*4+4*n+2]}}let i="";const h=[];for(let t=0;t<this.g-1;t+=2){let s="";for(let i=0;i<this.u;i++){const n=`rgb(${this.j[t*this.u*3+3*i+0]},${this.j[t*this.u*3+3*i+1]},${this.j[t*this.u*3+3*i+2]})`,r=`rgb(${this.j[(t+1)*this.u*3+3*i+0]},${this.j[(t+1)*this.u*3+3*i+1]},${this.j[(t+1)*this.u*3+3*i+2]})`,e=`background:linear-gradient(${n}, ${n} 50%, ${r} 50%, ${r})`;0!==h.length&&h[h.length-1]===e||(h.push(e),s+=o.A),s+=o.S}s+=o.C,i+=s}if(i+=o.A,h.push(""),this.M===i){if(e.isEqual(this.$,h))return;this.$=h,i+=o.S}this.M=i,console.log(i,...h)}}o.A="%c",o.C="\n",o.S=" ";class c{constructor(t){this.aabb=t}}c.COLOR=new Uint8ClampedArray([0,255,0]);class a{constructor(t){this.aabb=t,this.v=[0,h.VY]}}a.COLOR=new Uint8ClampedArray([255,0,0]);class u{constructor(){this.platforms=[],this.ball=new a(new r([0,0],[0,0])),this.score=0,this.gameover=!1}}class f extends class{constructor(){this.R=void 0,this.D=0,this.N=0,this.P=0,this.U=Date.now(),this._=t=>{this.D=window.requestAnimationFrame(this._);const s=t-this.N;this.N=t,this.update(s);const i=t-this.P;void 0!==this.R?i>this.R&&(this.P=t-i%this.R,this.render(i)):(this.P=t,this.render(i))}}set fps(t){this.R=1e3/t}start(){if(!this.isRunning()){const t=Date.now()-this.U;this.N+=t,this.P+=t,this.D=window.requestAnimationFrame(this._)}}stop(){window.cancelAnimationFrame(this.D),this.D=0,this.U=Date.now()}isRunning(){return 0!==this.D}}{constructor(){super(),this.F=new u;for(let t=f.J/2+2*f.L/f.X;t<f.L+3*f.L/f.X;t+=f.L/f.X)this.state.platforms.push(...this.Y(t));const t=this.state.platforms[0].aabb.maxX+f.q/2;this.F.ball.aabb.center=[t,f.G],this.F.ball.aabb.halfDimension=[f.G,f.G];const s=document.createElement("canvas");s.width=f.K,s.height=f.L,this.B=new o(s,f.H,f.I)}get state(){return this.F}update(t){const s=-(.05+.01*Math.floor(this.F.score/10))*t;this.F.ball.aabb.center[1]+=s;const i=[];for(const t of this.state.platforms)t.aabb.center[1]+=s,t.aabb.maxY<0&&i.push(t);if(i.length>0){for(const t of i)this.state.platforms.splice(this.state.platforms.indexOf(t),1);this.state.score+=i.length/2,this.state.platforms.push(...this.Y(i[i.length-1].aabb.center[1]+f.L+f.L/f.X))}if(0!==this.F.ball.v[1]){const s=[0,this.F.ball.v[1]*t];this.F.ball.aabb.center=n.add(this.F.ball.aabb.center,s);for(const t of this.state.platforms)if(!(t.aabb.maxY<this.state.ball.aabb.minY)&&this.state.ball.aabb.intersects(t.aabb)){const i=this.F.ball.aabb.halfDimension[1]+t.aabb.halfDimension[1]-Math.abs(this.F.ball.aabb.center[1]-t.aabb.center[1]);this.F.ball.aabb.center=n.sub(this.F.ball.aabb.center,[0,Math.sign(s[1])*(i+.001)]);break}}if(0!==this.F.ball.v[0]){const s=[this.F.ball.v[0]*t,0];this.F.ball.aabb.center=n.add(this.F.ball.aabb.center,s);for(const t of this.state.platforms)if(this.state.ball.aabb.intersects(t.aabb)){const i=this.F.ball.aabb.halfDimension[0]+t.aabb.halfDimension[0]-Math.abs(this.F.ball.aabb.center[0]-t.aabb.center[0]);this.F.ball.aabb.center=n.sub(this.F.ball.aabb.center,[Math.sign(s[0])*(i+.001),0]);break}}if(this.F.ball.aabb.minX<0&&(this.F.ball.aabb.center=[0+this.F.ball.aabb.halfDimension[0],this.F.ball.aabb.center[1]]),this.F.ball.aabb.maxX>f.K&&(this.F.ball.aabb.center=[f.K-this.F.ball.aabb.halfDimension[0],this.F.ball.aabb.center[1]]),this.F.ball.aabb.minY<0)return this.stop(),this.F.gameover=!0,void window.setTimeout(()=>{const t=window.localStorage.getItem("falldown"),s=null!==t?JSON.parse(t):{highscore:0},i=this.F.score>s.highscore;i&&(s.highscore=this.F.score,window.localStorage.setItem("falldown",JSON.stringify(s))),console.log(`💀 Game over!  🏆 ${i?"New highscore":"Score"}: ${this.F.score}  🔁 Press ${e.isMac()?"⌘":"⌃"}R to play again.`)},0);this.F.ball.aabb.maxY>f.L&&(this.F.ball.aabb.center=[this.F.ball.aabb.center[0],f.L-this.F.ball.aabb.halfDimension[1]])}render(t){this.B.render(this.F)}Y(t){const s=f.q+(f.K-2*f.q)*Math.random(),i=s-f.q/2-0,h=f.K-(s+f.q/2);return[new c(new r([i/2,t],[i/2,f.J/2])),new c(new r([s+f.q/2+h/2,t],[h/2,f.J/2]))]}}f.K=200,f.L=400,f.H=20,f.I=40,f.X=7,f.J=10,f.q=f.K/5,f.G=f.K/20;i(0);(()=>{e.isMac()&&(document.getElementById("key1").textContent="⌥",document.getElementById("key2").textContent="⌘"),-1===navigator.userAgent.indexOf("Chrome")&&(-1!==navigator.userAgent.indexOf("Firefox")?document.getElementById("key3").textContent="K":-1!==navigator.userAgent.indexOf("Safari")&&(document.getElementById("key3").textContent="C"));const t=new f;t.fps=24,t.start(),document.addEventListener("keydown",s=>{"ArrowLeft"===s.key?t.state.ball.v[0]=-h.VX:"ArrowRight"===s.key&&(t.state.ball.v[0]=h.VX)}),document.addEventListener("keyup",s=>{"ArrowLeft"!==s.key&&"ArrowRight"!==s.key||(t.state.ball.v[0]=0)}),window.addEventListener("blur",s=>{!t.state.gameover&&t.isRunning()&&(t.stop(),console.log("⏸ Paused. Click anywhere on the page to resume."))}),document.addEventListener("click",s=>{t.state.gameover||t.isRunning()||t.start()})})()}]);